import{w as u}from"./Da5tC44D.js";import{s as n}from"./CxqqRnSu.js";import{d as m}from"./CB5cRc80.js";const o=u([]),i=u(!1);async function y(){i.set(!0);try{const{data:a,error:r}=await n.from("gallery").select("*").order("ordine",{ascending:!0});if(r)throw r;o.set(a||[])}catch(a){console.error("Errore caricamento gallery:",a),o.set([])}finally{i.set(!1)}}async function p(a,r=""){try{const e=m(o),s=e.length>0?Math.max(...e.map(l=>l.ordine)):0,{data:t,error:c}=await n.from("gallery").insert([{immagine_url:a,alt_text:r,ordine:s+1}]).select().single();if(c)throw c;return o.update(l=>[...l,t]),{success:!0,data:t}}catch(e){return console.error("Errore aggiunta immagine:",e),{success:!1,error:e.message}}}async function h(a){try{const{error:r}=await n.from("gallery").delete().eq("id",a);if(r)throw r;return o.update(e=>e.filter(s=>s.id!==a)),{success:!0}}catch(r){return console.error("Errore eliminazione immagine:",r),{success:!1,error:r.message}}}async function w(a){try{const r=a.map((s,t)=>({id:s.id,ordine:t+1})),{error:e}=await n.from("gallery").upsert(r);if(e)throw e;return o.set(a),{success:!0}}catch(r){return console.error("Errore aggiornamento ordine:",r),{success:!1,error:r.message}}}async function x(a,r){try{const{error:e}=await n.from("gallery").update({alt_text:r}).eq("id",a);if(e)throw e;return o.update(s=>s.map(t=>t.id===a?{...t,alt_text:r}:t)),{success:!0}}catch(e){return console.error("Errore aggiornamento alt text:",e),{success:!1,error:e.message}}}export{p as a,w as b,h as d,o as g,y as l,x as u};
